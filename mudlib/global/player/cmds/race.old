
/* Race command from player.c externalized by Baldrick.
 */
// Added by Radix, an easy command to see a player's race
// yes, ALL will be matched in find_match ...
// September 28, 1995

// Bah, Hamlet had his hands all over this but didn't admit it
#include <standard.h>
#include <cmd.h>

inherit CMD_BASE;

void setup()
{
	position = 0;
}

string query_usage()
{
	return "race";
}

string query_short_help()
{
	return "Shows something.";
}

static int cmd (string name, object me)
{
   int i;
   int sz;
   object *obs;
   string race;
   if(!stringp(name))
   {
      notify_fail("Syntax: race <name>\n");
      return(0);
   }
   obs = find_match(name,environment(me));
   if((sizeof(obs) == 1) && (obs[0] == this_player())) {
     notify_fail("You don't know your own race?  Try looking at yourself.\n");
     return 0;
   }

   obs -= ({ this_player() });
   if(!sizeof(obs))
   {
      notify_fail("Syntax: race <name>\n");
      return(0);
   }
   sz = sizeof(obs);
   for(i=0; i<sz; i++)
   {
      if(!obs[i]->query_npc() && !interactive(obs[i]))
      {  
         if(sz == 1)
           write(obs[i]->query_short()+" : Not a creature\n");
         continue;
      }
      if((obs[i]->query_hide_shadow()) || (obs[i]->query_short() == "") ||
         (!obs[i]->query_short()) || (obs[i]->query_invis()))
      {
         if(sz == 1)
         {
            notify_fail("Syntax: race <name>\n");
            return(0);
         }
         else
            continue;
      }
      race = obs[i]->query_race();
      if(!stringp(race)) race = "Look closer";
      write(obs[i]->query_short()+" : "+capitalize(race)+"\n");
   }
   return 1;
}
